# 学习器

[burnd-train](https://github.com/tracel-ai/burn/tree/main/crates/burn-train) crate封装了多个用于训练深度学习模型的实用程序。该crate的目标是为用户提供精心设计且灵活的训练循环，使项目无需从头开始编写这些组件。与`burn-train`的大多数交互都将通过`LearnerBuilder`结构体进行，该结构体在之前的[训练部分](../basic-workflow/training.md)中已简要介绍。该结构体使您能够配置训练循环，提供对注册指标、启用日志记录、检查点状态、使用多个设备等的支持。

当前提供的API仍有一些假设，这可能使它们不适合您的学习需求。确实，它们假设您的模型将从训练数据集中学习，并根据另一个数据集进行验证。这是最常见的范式，允许用户进行监督学习和无监督学习以及微调。然而，对于更复杂的需求，创建[自定义训练循环](../custom-training-loop.md)可能是您需要的。

## 使用

学习器构建器在配置方面提供了许多选项。

| 配置          | 描述                                                                    |
| ---------------------- | ------------------------------------------------------------------------------ |
| 训练指标        | 注册训练指标                                                     |
| 验证指标      | 注册验证指标                                                   |
| 训练指标图表   | 注册带图表的训练指标（要求指标为数值型）   |
| 验证指标图表 | 注册带图表的验证指标（要求指标为数值型） |
| 指标记录器          | 配置指标记录器（默认是将它们保存到文件中）                 |
| 渲染器               | 配置如何渲染指标（默认是CLI）                               |
| 梯度累积      | 配置应用梯度前的步数                        |
| 文件检查点              | 配置如何保存模型、优化器和调度器状态              |
| 训练周期数             | 设置训练周期数                                                       |
| 设备                | 设置要使用的设备                                                     |
| 检查点             | 从检查点重新开始训练                                             |
| 应用程序日志    | 配置应用程序日志安装程序（默认是写入`experiment.log`）                                   |

当构建器按您的喜好配置后，您可以继续构建学习器。构建方法需要三个输入：模型、优化器和学习率调度器。请注意，如果希望在训练期间保持恒定，后者可以是简单的浮点数。

结果将是一个新创建的学习器结构体，它只有一个方法，即必须使用训练和验证数据加载器调用的`fit`函数。这将开始训练，并在完成后返回训练好的模型。

请再次参考[训练部分](../basic-workflow/training.md)以获取相关的代码片段。

## 工件

创建新构建器时，所有收集的数据都将保存在作为`new`方法参数提供的目录下。以下是使用压缩消息包格式记录的模型示例数据布局，已注册准确率和损失指标：

```
├── experiment.log
├── checkpoint
│   ├── model-1.mpk.gz
│   ├── optim-1.mpk.gz
│   └── scheduler-1.mpk.gz
│   ├── model-2.mpk.gz
│   ├── optim-2.mpk.gz
│   └── scheduler-2.mpk.gz
├── train
│   ├── epoch-1
│   │   ├── Accuracy.log
│   │   └── Loss.log
│   └── epoch-2
│       ├── Accuracy.log
│       └── Loss.log
└── valid
    ├── epoch-1
    │   ├── Accuracy.log
    │   └── Loss.log
    └── epoch-2
        ├── Accuracy.log
        └── Loss.log
```

如果需要，您可以选择将该本地目录保存或与远程文件系统同步。文件检查点能够根据指定的配置自动删除旧的检查点。